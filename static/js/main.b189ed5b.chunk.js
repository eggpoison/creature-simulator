(this["webpackJsonpcreature-simulator"]=this["webpackJsonpcreature-simulator"]||[]).push([[0],Array(20).concat([function(e,t,i){var n={"./egg/egg-0.png":21,"./egg/egg-1.png":22,"./egg/egg-2.png":23,"./egg/egg-3.png":24,"./egg/egg-4.png":25,"./heart/heart-0.png":26,"./heart/heart-1.png":27,"./heart/heart-2.png":28,"./heart/heart-3.png":29,"./smoke/smoke-0.png":30,"./smoke/smoke-1.png":31,"./smoke/smoke-2.png":32,"./smoke/smoke-3.png":33,"./smoke/smoke-4.png":34};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id=20},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAEBJREFUKFOFT1sKACAIm/c/9MJyphTlh+heoqEXYzXBOQAguXizCe9WyXSGSAnpvgkOsoo84Stww/OEEvVi+3AAKPcaB3YCGM0AAAAASUVORK5CYII="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAE1JREFUKFNtj0sSACAIQvHa7j03jRX2bdGU4EMN5+H8msr1AEBy6Ga9vK5drM5pEoHujoioQFHSUOhrnh71NaSQ88iQjQ9ljxBZKx4bNv3HHQfqLQCjAAAAAElFTkSuQmCC"},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAE5JREFUKFNdj9EWACAEQ+e7PftuHTJRD53Y3Eawj1cpbPcDgLtfXSTb75piT5aJhBwlYVLC0GhVhZl1qvhqGSY+aDQU/QYkhUHXFt/KqR3dtSMH1GudvAAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAFBJREFUKFNdT0kSACAIwnd71m/baGFZhyYhFgXzxBmFcD8ARMTmRQq+10u28nyiQ0npoKpw9232W38xlVPZqTKz7pBYdumIV0mSEezFFceGC34GKQfwUlcMAAAAAElFTkSuQmCC"},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAAFFJREFUKFNtT0EOACAI0m/rWb9ti6Jyq4MrIBCVfmo/lfC5iEhVLV4V8B0k3V0ioonogK90mMLMXGYfawh3DHKQPYF3B2In4iXNrEWwESu2hgOIACwH4GvOyAAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAADxJREFUKFOFTlsKACAI2+5/6GLWYJGg+CF7SgxD8asWIMC8CzPQBckwC7IiU+S+tQfOKpOPwKIkP0H36AZOTA4J8eyzugAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAADhJREFUKFNjZCAAGIlWcJiB4b8tAwMjjIZpBJsAEkQ3CaQYJAa3AlkRTBJFAcwkZEkMBdgcTNAXALJPCgmBiBW0AAAAAElFTkSuQmCC"},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAACpJREFUKFNjZCAAGKmroJeB4X8xAwOKqXAOSBJmHbIiFNV4TcDlWIK+AADFugYJ3JGn6wAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAABtJREFUKFNjZCAAGOmsIISB4f8aBgYUa+ngBgDt+AIJegq8GAAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAADRJREFUKFNjZCAAGNHl/////5+RkREuDmagCyJrQjEBm0K4AmRJZDaGG2DGwxQRbwUu3wIAPA4cCXVv7EcAAAAASUVORK5CYII="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAACxJREFUKFNjZCAAGIlW8P////+MjIwYGjAEYAphNIoCbKYQ7waYY9FNIWgCAPvjFAmHkFgYAAAAAElFTkSuQmCC"},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAACZJREFUKFNjZCAAGKmr4P////9BJjIyMsJNJs8KkEkwU8gzAdlnAJGpCAmOYY4DAAAAAElFTkSuQmCC"},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAACRJREFUKFNjZCAAGKmv4P////8ZGRnhJqNYgS4Jsp4GbkD3FQAlyAgJTFh8HgAAAABJRU5ErkJggg=="},function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAAAXNSR0IArs4c6QAAABtJREFUKFNjZCAAGAdAwf////8zMjLCraaDGwDLqwQJfZ00UQAAAABJRU5ErkJggg=="},function(e,t,i){},,function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){},function(e,t,i){"use strict";i.r(t),i.d(t,"hideMask",(function(){return _e})),i.d(t,"showMask",(function(){return He}));var n=i(2),a=i.n(n),s=i(11),r=i.n(s),o=i(1),c=i(3),l=i(4),h=i(10),u=i.n(h),d=i(12),f=i(9),p=i(8),v=i(5),m=function(){function e(t,i){Object(c.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=i}return Object(l.a)(e,[{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"lerp",value:function(t,i){return new e(j(this.x,t.x,i),j(this.y,t.y,i))}},{key:"distanceFrom",value:function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{key:"angleBetween",value:function(e){return Math.atan2(e.y-this.y,e.x-this.x)}},{key:"convertToPolar",value:function(t){var i=t||new e(0,0),n=this.distanceFrom(i),a=this.angleBetween(i);return new g(n,a)}},{key:"randomOffset",value:function(e){var t=b(0,e),i=b(0,360),n=new g(t,i);return this.add(n.convertToCartesian())}},{key:"copy",value:function(){return new e(this.x,this.y)}}],[{key:"randomUnitVector",value:function(){var t=2*Math.random()*Math.PI;return new e(Math.cos(t),Math.sin(t))}}]),e}(),g=function(){function e(t,i){Object(c.a)(this,e),this.magnitude=void 0,this.direction=void 0,this.magnitude=t,this.direction=i}return Object(l.a)(e,[{key:"convertToCartesian",value:function(){var e=Math.cos(this.direction)*this.magnitude,t=Math.sin(this.direction)*this.magnitude;return new m(e,t)}}],[{key:"randomUnitVector",value:function(){return new e(1,b(0,360))}}]),e}();function A(e){var t=document.getElementById(e);if(!t)throw new Error("ungaming: tried to find element with an id of '".concat(e,"' but could not find any.'"));return t}function y(e,t){if(e>=t)throw new Error("Min of '".concat(e,"' is greater than max of '").concat(t,"'"));return Math.floor(Math.random()*(t-e))+e}function b(e,t){if(e>=t)throw new Error("Min of '".concat(e,"' is greater than max of '").concat(t,"'"));return Math.random()*(t-e)+e}function x(e){return e[y(0,e.length)]}function j(e,t,i){return(1-i)*e+i*t}function w(e,t){var i=Math.pow(10,t);return Math.round((e+Number.EPSILON)*i)/i}function O(e){var t=e.length,i=e.reduce((function(e,t){return e+t}))/t,n=e.map((function(e){return Math.pow(e-i,2)})).reduce((function(e,t){return e+t}))/t;return Math.sqrt(n)}var k=function(){function e(t){Object(c.a)(this,e),this._hex=void 0,this._rgb=void 0,"string"===typeof t?(this._hex=t.toLowerCase(),7===this._hex.length&&(this._hex=this._hex.substring(1,7)),this._rgb=this.getRGB()):(this._rgb=t,this._hex=e.getHex(this._rgb))}return Object(l.a)(e,[{key:"hex",get:function(){return"#"+this._hex}},{key:"rgb",get:function(){var e=Object(v.a)(this._rgb,3),t=e[0],i=e[1],n=e[2];return"rgb(".concat(t,", ").concat(i,", ").concat(n,")")}},{key:"getRGB",value:function(){for(var e="0123456789abcdef".split(""),t=[0,0,0],i=0;i<3;i++){var n=e.indexOf(this._hex[2*i]),a=e.indexOf(this._hex[2*i+1]);t[i]=16*n+a}return t}},{key:"darken",value:function(t){return new e(this._rgb.map((function(e){return Math.round(e*(1-t))})))}},{key:"desaturate",value:function(t){var i=this._rgb.slice(),n=.3086*i[0]+.6094*i[1]+.082*i[2];return i[0]=Math.round(j(i[0],n,t)),i[1]=Math.round(j(i[1],n,t)),i[2]=Math.round(j(i[2],n,t)),new e([i[0],i[1],i[2]])}}],[{key:"getHex",value:function(e){for(var t="0123456789abcdef".split(""),i="",n=0;n<3;n++){var a=e[n],s=a%16;i+=t[(a-s)/16]+t[s]}return i}},{key:"grayscale",value:function(t){var i=Math.floor(255*t);return e.getHex([i,i,i])}}]),e}();var S=function(){function e(t,i){Object(c.a)(this,e),this.position=void 0,this.velocity=void 0,this.age=void 0,this.lifespan=void 0,this.element=void 0,this.position=t,this.velocity=new m(0,0),this.age=0;for(var n=0,a=Object.entries(i);n<a.length;n++){var s=a[n];this[s[0]]=s[1]}this.element=this.instantiate(),this.createEntity(),this.updatePosition(),Re.board.createEntity(this)}return Object(l.a)(e,[{key:"createEntity",value:function(){var e,t;return A("board").appendChild(this.element),"number"===typeof this.size?(e=this.size,t=this.size):(e=this.size.x,t=this.size.y),this.element.style.width=e+"px",this.element.style.height=t+"px",this.element}},{key:"tick",value:function(){this.age++>=this.lifespan?this.die():(this.position=this.position.add(this.velocity),Re.board.updateEntity(this),this.updatePosition())}},{key:"updatePosition",value:function(){this.element.style.left="".concat(this.position.x,"px"),this.element.style.top="".concat(this.position.y,"px")}},{key:"die",value:function(){this.element.remove(),Re.board.deleteEntity(this)}},{key:"isCollidingWithEntity",value:function(e){var t=this.position.distanceFrom(e.position);return"number"===typeof this.size?t-this.size/2<=0:"number"===typeof e.size?t-this.size.x/2-e.size/2<=0:t-this.size.x/2-e.size.x/2<=0}}],[{key:"count",value:function(e){var t,i=0,n=Object(o.a)(Re.board.cells);try{for(n.s();!(t=n.n()).done;){var a,s=t.value,r=Object(o.a)(s);try{for(r.s();!(a=r.n()).done;){var c=a.value;e.prototype.isPrototypeOf(c)&&i++}}catch(l){r.e(l)}finally{r.f()}}}catch(l){n.e(l)}finally{n.f()}return i}}]),e}();function C(e){var t,i={lifespan:10*Re.tps,size:8};t=e?Re.board.randomPositionInCell(e):Re.board.randomPosition();var n=Re.board.getFruitColour(t);new M(t,i,n)}var N,E,M=function(e){Object(f.a)(i,e);var t=Object(p.a)(i);function i(e,n,a){var s;return Object(c.a)(this,i),(s=t.call(this,e,n)).element.style.backgroundColor=a,s}return Object(l.a)(i,[{key:"instantiate",value:function(){var e=document.createElement("div");return e.className="fruit",e}}]),i}(S),z=M,T=new Array,R=function(){function e(t,i,n,a,s,r){Object(c.a)(this,e),this.name=void 0,this.position=void 0,this.element=void 0,this.width=void 0,this.height=void 0,this.numFrames=void 0,this.frame=0,this.ticksPerFrame=void 0,this.name=t,this.width=a,this.height=s,this.numFrames=i,this.ticksPerFrame=n,this.position=r,this.init(),this.updateBackgroundImage(),T.push(this)}return Object(l.a)(e,[{key:"init",value:function(){this.element=document.createElement("div"),this.element.className="game-image",this.element.style.width=this.width+"px",this.element.style.height=this.height+"px",A("board").appendChild(this.element),this.element.style.backgroundSize="".concat(this.width,"px ").concat(this.height,"px"),this.element.style.top=this.position.y+"px",this.element.style.left=this.position.x+"px"}},{key:"updateBackgroundImage",value:function(){var e=Math.floor(this.frame),t=i(20)("./".concat(this.name,"/").concat(this.name,"-").concat(e,".png")).default;this.element.style.backgroundImage="url(".concat(t,")")}},{key:"tick",value:function(){this.frame+=1/this.ticksPerFrame,this.frame>=this.numFrames?this.die():this.updateBackgroundImage()}},{key:"die",value:function(){this.element.remove(),T.splice(T.indexOf(this),1)}}]),e}(),F=!1,I=null;function L(){F=!1,I=null,N(null)}var P=i(7),U=i(6),D=function(e){Object(f.a)(i,e);var t=Object(p.a)(i);function i(e,n,a,s){var r;return Object(c.a)(this,i),(r=t.call(this,e,n)).generation=void 0,r.generation=s,r.creatureAttributes=a,r}return Object(l.a)(i,[{key:"instantiate",value:function(){var e=Math.floor(this.lifespan/5);return new R("egg",5,e,this.size,this.size,this.position).element}},{key:"tick",value:function(){Object(P.a)(Object(U.a)(i.prototype),"tick",this).call(this);var e=1.25*Math.sin(Re.ticks*Re.tps);this.element.style.transform="translate(-50%, -50%) rotate(".concat(e,"deg)")}},{key:"die",value:function(){Object(P.a)(Object(U.a)(i.prototype),"die",this).call(this),new X(this.position.copy(),this.creatureAttributes).stats.generation=this.generation}}]),i}(S),V={speed:{display:"speed",colour:"#eeff00",min:3,max:10,weight:1,positivelyAffectsLifespan:!1},size:{display:"size",colour:"#ff8f00",min:10,max:30,weight:1,positivelyAffectsLifespan:!0},vision:{display:"vision",colour:"#5400ff",min:25,max:75,weight:1,positivelyAffectsLifespan:!1},reproductiveRate:{display:"reproductive rate",colour:"#ff00e0",min:.5,max:2,weight:1}},G=function(e){for(var t=10*Re.tps,i=0,n=Object.entries(V);i<n.length;i++){var a=n[i];if(a[1].positivelyAffectsLifespan){var s=e[a[0]];a[1].positivelyAffectsLifespan?t*=Math.pow(s/((a[1].min+a[1].max)/2),a[1].weight):t*=Math.pow((a[1].min+a[1].max)/2/s,a[1].weight)}}return t},B=function(e){var t=V[e];return b(t.min,t.max)},Y=function(){for(var e=["Amoeba"],t=[],i=["Feeble","Crippled","Schizophrenic"].slice();0!==i.length&&Math.random()<=.4;){var n=y(0,i.length);t.push(i[n]),i.splice(n,1)}var a=t.reduce((function(e,i,n){var a=e;return n>0&&t.length-n>1?a+=", ":t.length>1&&t.length-n===1&&(a+=" and "),a+i}),""),s=Math.random()<=.3,r=x(["Glorb","James","Obama","Gnark"]);return s&&t.length>0?r+=" the "+a+" "+x(e):t.length>0?r+=" the "+a:s&&(r+=" the "+x(e)),r};function J(){var e={name:Y(),size:B("size"),speed:B("speed"),vision:B("vision"),reproductiveRate:B("reproductiveRate"),lifespan:0};e.lifespan=G(e);var t=b(0,Re.boardSize.width*Re.cellSize),i=b(0,Re.boardSize.height*Re.cellSize),n=new m(t,i);new q(n,e)}var K,Q=2e3,q=function(e){Object(f.a)(i,e);var t=Object(p.a)(i);function i(e,n){var a;return Object(c.a)(this,i),(a=t.call(this,e,n)).speed=void 0,a.moveSpeed=void 0,a.vision=void 0,a.reproductiveRate=void 0,a.birthTime=void 0,a.isMoving=void 0,a.targetPosition=null,a.reproductiveUrge=0,a.partner=null,a.reproductionStage=0,a.lastReproductionTime=-2e3-Re.settings.eggIncubationTime-4e3,a.stats={fruitEaten:0,generation:1},a.speed=n.speed,a.vision=n.vision,a.reproductiveRate=n.reproductiveRate,a.isMoving=!1,a.birthTime=Re.ticks,a.moveSpeed=a.calculateMoveSpeed(),a}return Object(l.a)(i,[{key:"calculateMoveSpeed",value:function(){var e=V.size.max/V.size.min/3;return this.speed/Math.pow(this.size/V.size.min/e,1.1)}},{key:"instantiate",value:function(){var e=document.createElement("div");return e.className="creature",e.innerHTML='\n      <div class="shadow"></div>\n\n      <div class="life">\n         <div class="life-bar"></div>\n\n         </div>\n      <div class="reproduction">\n         <div class="reproduction-bar"></div>\n      </div>\n      ',e.style.setProperty("--vision-size","".concat(this.vision,"px")),e.style.setProperty("--creature-size","".concat(this.size,"px")),e}},{key:"life",get:function(){return(this.lifespan-this.age)/this.lifespan*100}},{key:"updateLifebar",value:function(){var e=this.element.querySelector(".life-bar");e.style.width="".concat(this.life,"%");var t=155+this.life;e.style.backgroundColor="rgb(".concat(t,", 0, 0)")}},{key:"updateReproductionBar",value:function(){this.element.querySelector(".reproduction-bar").style.width="".concat(this.reproductiveUrge,"%")}},{key:"wantsToReproduce",get:function(){return this.reproductiveUrge>this.life&&this.reproductionStage<2}},{key:"tick",value:function(){if(Object(P.a)(Object(U.a)(i.prototype),"tick",this).call(this),0===this.reproductionStage&&1e3*(Re.ticks-this.lastReproductionTime)/Re.tps>Q+Re.settings.eggIncubationTime+4e3){this.element.classList.remove("abstaining");this.reproductiveUrge+=2*this.reproductiveRate/Re.tps,this.reproductiveUrge=Math.min(100,this.reproductiveUrge)}else this.reproductionStage>=2&&(this.age-=1);switch(this.updateLifebar(),this.updateReproductionBar(),null!==this.targetPosition&&(this.hasReachedTargetPosition()?this.reachTargetPosition():this.moveToTargetPosition()),this.reproductionStage){case 1:if(Math.random()<=3/Re.tps){var e=this.position.randomOffset(30);new R("heart",4,2,16,16,e)}break;case 2:if(Math.random()<=3/Re.tps)for(var t=y(4,11),n=0;n<t;n++)if(Math.random()<=.7){var a=this.position.randomOffset(40),s=y(12,24);new R("heart",4,3,s,s,a)}if(Math.random()<6/Re.tps){var r=this.position.randomOffset(20),c=y(12,18);new R("heart",4,3,c,c,r)}}var l=Re.board.getNearby(this.position,this.vision),h=l.indexOf(this);-1!==h&&l.splice(h,1);var u,d=null,f=Number.MAX_SAFE_INTEGER,p=null,v=Number.MAX_SAFE_INTEGER,m=Object(o.a)(l);try{for(m.s();!(u=m.n()).done;){var g=u.value,A=g instanceof z;if(g instanceof i&&this.wantsToReproduce&&g.wantsToReproduce&&(null===g.partner||g.partner===this)){var b=this.position.distanceFrom(g.position);b<v&&(p=g,v=b)}else if(A){var x=this.position.distanceFrom(g.position);x<f&&(d=g,f=x)}Object(P.a)(Object(U.a)(i.prototype),"isCollidingWithEntity",this).call(this,g)&&(g===this.partner&&this.wantsToReproduce?this.handleReproduction():A&&this.eatFruit(g))}}catch(w){m.e(w)}finally{m.f()}if(null!==p&&this.reproductionStage<2)return this.targetPosition=p.position,this.partner=p,void(this.reproductionStage=1);if(1===this.reproductionStage)this.reproductionStage=0;else if(this.reproductionStage>=2)return;if(null===d){if(!this.isMoving){if(Math.random()<.95/Re.tps){var j=Re.board.randomNearbyPosition(this.position,this.vision);this.targetPosition=j}}}else this.targetPosition=d.position}},{key:"eatFruit",value:function(e){this.stats.fruitEaten++;this.age-=10*Re.tps,this.age=Math.max(this.age,0),e.die()}},{key:"getEntitiesInVision",value:function(e){var t=this;return e.filter((function(e){return t.canSeeEntity(e)}))}},{key:"canSeeEntity",value:function(e){return this.position.distanceFrom(e.position)<=this.vision+this.size/2}},{key:"moveToTargetPosition",value:function(){this.isMoving=!0,this===I&&function(e,t){var i=e.distanceFrom(t),n=e.angleBetween(t),a=document.createElement("div");A("board").appendChild(a),a.className="ray",a.style.transform="rotate(".concat(n,"rad)"),a.style.width=i+"px",a.style.left=e.x+"px",a.style.top=e.y+"px"}(this.position,this.targetPosition);var e=this.position.angleBetween(this.targetPosition),t=new g(this.moveSpeed,e);this.velocity=t.convertToCartesian()}},{key:"hasReachedTargetPosition",value:function(){var e=new m(this.position.x-this.targetPosition.x,this.position.y-this.targetPosition.y);return this.velocity.dot(e)>0}},{key:"reachTargetPosition",value:function(){this.isMoving=!1,this.velocity=new m(0,0),this.targetPosition=null}},{key:"handleReproduction",value:function(){var e=this;this.reproduce().then((function(){return e.layEgg()}))}},{key:"reproduce",value:function(){var e=this;return new Promise((function(t){e.reproductionStage=2,e.targetPosition=null,e.velocity=new m(0,0),e.isMoving=!1,e.reproductiveUrge=0,e.element.classList.add("abstaining"),e.lastReproductionTime=Re.ticks,setTimeout((function(){t()}),Q)}))}},{key:"layEgg",value:function(){var e=this;return new Promise((function(t){if(e.reproductionStage=0,0!==e.partner.reproductionStage){var i=e.generateChildGenes(e.partner),n={size:20,lifespan:Re.settings.eggIncubationTime/1e3*Re.tps},a=e.position.randomOffset(10);new D(a,n,i,e.stats.generation+1)}e.partner=null,setTimeout((function(){t()}),Re.settings.eggIncubationTime)}))}},{key:"generateChildGenes",value:function(e){for(var t={name:Y()},i=0,n=Object.keys(V);i<n.length;i++){var a=n[i],s=Math.random()<=.5?this[a]:e[a];t[a]=s,Math.random()<=.3&&(s=this.mutateGene(a,s))}return t.lifespan=G(t),t}},{key:"mutateGene",value:function(e,t){var i=V[e],n=(i.min+i.max)/300;return n*=b(.1,1)*Re.settings.creatureMutationRate,n*=Math.sign(Math.random()-.5),t+(n*=Re.settings.creatureMutationRate)}},{key:"die",value:function(){this===I&&L(),Object(P.a)(Object(U.a)(i.prototype),"die",this).call(this)}}]),i}(S),X=q,_=(i(35),i(0)),H=function(e){var t=e.name,i=e.text,a=e.defaultValue,s=e.func,r=Object(n.useRef)(null),o=Object(n.useState)(a),c=Object(v.a)(o,2),l=c[0],h=c[1],u="_INPUT_"+t,d="input-checkbox ".concat(l?"selected":"");return Object(_.jsxs)("div",{className:d,children:[Object(_.jsx)("input",{ref:r,onChange:function(){var e=!!Number(r.current.checked);s&&s(e,r.current),h(e)},type:"checkbox",id:u,defaultChecked:a}),Object(_.jsx)("label",{htmlFor:u,children:i})]})},W=function(e){var t=e.text,i=e.min,a=e.max,s=e.defaultValue,r=e.step,o=e.func,c=e.button,l=e.hasExtremeMode,h=Object(n.useRef)(null),u=Object(n.useState)(s),d=Object(v.a)(u,2),f=d[0],p=d[1],m="input-range  ".concat(!!l&&f>=a?"extreme":"");return Object(_.jsxs)("div",{className:m,children:[Object(_.jsxs)("div",{className:"formatter",children:[Object(_.jsx)("div",{className:"text",children:t}),Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{className:"value",children:f}),Object(_.jsxs)("div",{className:"bar-container",children:[Object(_.jsx)("div",{className:"min",children:i}),Object(_.jsx)("input",{ref:h,onInput:function(){var e=Number(h.current.value);o&&void 0===c&&o(e),p(e)},type:"range",min:i,max:a,step:r,defaultValue:s}),Object(_.jsx)("div",{className:"max",children:a})]})]})]}),c?Object(_.jsx)("button",{onClick:function(){o&&o(f)},children:c}):""]})},Z=function(e){for(var t=0;t<e;t++)J()},$=function(e){for(var t=0;t<e;t++)C()},ee=function(e){Re.timewarp=e},te=function(){A("control-panel").classList.remove("hidden"),A("expand-icon").classList.add("hidden")},ie=function(){A("control-panel").classList.add("hidden"),A("expand-icon").classList.remove("hidden")},ne=function(){var e=a.a.useState({}),t=Object(v.a)(e,2)[1],i=a.a.useCallback((function(){return t({})}),[]);return Object(n.useEffect)((function(){K=i}),[i]),Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{id:"expand-icon",className:"hidden",onClick:te,children:[Object(_.jsxs)("div",{className:"formatter",children:[Object(_.jsx)("div",{className:"vertical-bar"}),Object(_.jsx)("div",{className:"horizontal-bar"})]}),Object(_.jsx)("div",{className:"text",children:"Control Panel"})]}),Object(_.jsxs)("div",{id:"control-panel",className:"menu",children:[Object(_.jsx)("div",{className:"collapse-icon",onClick:ie,children:Object(_.jsx)("div",{className:"horizontal-bar"})}),Object(_.jsx)("h1",{className:"heading",children:"Control Panel"}),Object(_.jsx)("h2",{className:"subheading",children:"Settings"}),Object(_.jsx)(H,{name:"dark-mode",text:"Dark Mode",defaultValue:!0,func:function(e){return function(e){e?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")}(e)}}),Object(_.jsx)(H,{name:"show-debug-output",text:"Show Debug Output",defaultValue:!1,func:function(e){return function(e){Re.settings.showDebugOutput=e}(e)}}),Re.hasStarted?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("button",{id:"open-graph-viewer-button",children:"View Graphs"}),Object(_.jsx)("h2",{className:"subheading",children:"Overview"}),Object(_.jsxs)("p",{children:["Creatures: ",S.count(X)]}),Object(_.jsxs)("p",{children:["Fruit: ",S.count(z)]}),Object(_.jsxs)("p",{children:["Time elapsed: ",w(Re.ticks/20,1)," seconds ",Object(_.jsxs)("i",{children:["(",Re.ticks," ticks)"]})]}),Object(_.jsx)("h2",{className:"subheading",children:"Creatures"}),Object(_.jsx)(W,{button:"Create",text:"Create creatures",min:1,max:10,defaultValue:1,step:1,func:Z}),Object(_.jsx)(W,{button:"Create",text:"Create fruit",min:5,max:100,defaultValue:5,step:5,func:$}),Object(_.jsx)("h2",{className:"subheading",children:"World"}),Object(_.jsx)(W,{text:"Timewarp",min:1,max:10,defaultValue:1,step:1,func:ee,hasExtremeMode:!0})]}):""]})]})},ae=function(){function e(t,i,n,a,s){Object(c.a)(this,e),this.data=void 0,this.element=void 0,this.width=void 0,this.height=void 0,this.time=Re.ticks,this.settings=void 0,this.options=void 0,this.minY=void 0,this.maxY=void 0,this.xAxisMeasurements=10,this.timeUnit=this.calculateTimeUnit(this.time),this.width=t,this.height=i,this.data=n,this.settings=a,this.options=s,this.minY=this.calculateMinY(),this.maxY=this.calculateMaxY(),this.element=this.instantiate(),this.plotData(),this.createAxes(),this.createLabels()}return Object(l.a)(e,[{key:"instantiate",value:function(){var e=document.createElement("div");return e.className="graph",e.style.width=this.width+"px",e.style.height=this.height+"px",e}},{key:"calculateMinY",value:function(){return this.options.min?this.options.min:0}},{key:"calculateMaxY",value:function(){if(this.options.max)return this.options.max;var e=0;if("simple"===this.options.type){var t,i=Object(o.a)(this.data);try{for(i.s();!(t=i.n()).done;){var n=t.value;null!==n&&n>e&&(e=n)}}catch(c){i.e(c)}finally{i.f()}}else if("detailed"===this.options.type){var a,s=Object(o.a)(this.data);try{for(s.s();!(a=s.n()).done;){var r=a.value;null!==r&&r.max>e&&(e=r.max)}}catch(c){s.e(c)}finally{s.f()}}return e}},{key:"calculateTimeUnit",value:function(e){return e/20/this.xAxisMeasurements>60?"minutes":"seconds"}},{key:"drawPoint",value:function(e,t){var i=document.createElement("div");i.className="point",i.style.backgroundColor=t,this.element.appendChild(i),i.style.left=e.x+"px",i.style.bottom=e.y+"px"}},{key:"drawLine",value:function(e,t,i){var n=document.createElement("div");n.className="line",this.element.appendChild(n),n.style.left=e.x+"px",n.style.bottom=e.y+"px",n.style.backgroundColor=i;var a=e.distanceFrom(t),s=-e.angleBetween(t);n.style.width=a+"px",n.style.transform="rotate(".concat(s,"rad)")}},{key:"drawRect",value:function(e,t,i,n){var a=document.createElement("div");a.className="rect",this.element.appendChild(a),a.style.width=t+"px",a.style.height=i+"px",a.style.backgroundColor=n,a.style.left=e.x+"px",a.style.bottom=e.y+"px"}},{key:"drawTrangle",value:function(e,t,i,n,a){var s=document.createElement("div");s.className="triangle ".concat(a),this.element.appendChild(s),s.style.setProperty("--width",i/2+"px"),s.style.setProperty("--height",t/2+"px"),s.style.setProperty("--colour",n),s.style.left=e.x+"px",s.style.bottom=e.y+"px"}},{key:"getData",value:function(){var e;if(!this.settings.shouldExtrapolate||this.data.length<=75)return this.data;("simple"===this.options.type||"detailed"===this.options.type)&&(e=new Array);for(var t=0;t<75;t++){var i=this.data.length*t/75;if("simple"===this.options.type){var n=void 0,a=i%1;if(0===a)n=this.data[i];else{var s=this.data[Math.floor(i)],r=this.data[Math.ceil(i)];n=null===s&&null===r?null:null===s&&null!==r?r:null!==s&&null===r?s:j(s,r,a)}e.push(n)}else if("detailed"===this.options.type){var o=void 0,c=i%1;if(0===c)o=this.data[i];else{var l=this.data[Math.floor(i)],h=this.data[Math.ceil(i)];o=null===l&&null===h?null:null===l&&null!==h?h:null!==l&&null===h?l:{average:j(l.average,h.average,c),min:j(l.min,h.min,c),max:j(l.max,h.max,c),standardDeviation:j(l.standardDeviation,h.standardDeviation,c)}}e.push(o)}}return e}},{key:"plotData",value:function(){var e=this.getData();"simple"===this.options.type?this.plotSimpleData(e):"detailed"===this.options.type&&this.plotDetailedData(e)}},{key:"plotSimpleData",value:function(e){for(var t=null,i=0;i<e.length;i++){var n=e[i];if(null!==n){var a=this.width/(e.length-1),s=new m(a*i,this.height*(n-this.minY)/(this.maxY-this.minY));this.drawPoint(s,this.options.colour),i>0&&null!==t&&this.drawLine(t,s,this.options.colour),t=s}else t=null}}},{key:"draw",value:function(e,t,i,n,a,s){var r=new m(t*i,this.height*(n-this.minY)/(this.maxY-this.minY));return s&&this.drawPoint(r,e),i>0&&null!==a&&this.drawLine(a,r,e),r}},{key:"plotDetailedData",value:function(e){var t=new k(this.options.colour),i=t.desaturate(.3);i=i.darken(.2);var n=t.desaturate(.7);n=n.darken(.2);for(var a=e.length,s=null,r=null,o=null,c=null,l=null,h=0;h<a;h++){var u=e[h];if(null!==u){var d=this.width/(a-1);s=this.draw(this.options.colour,d,h,u.average,s,!0),r=this.draw(n.hex,d,h,u.min,r,!1),o=this.draw(n.hex,d,h,u.max,o,!1);var f=this.draw(i.hex,d,h,u.average-u.standardDeviation,c,!1),p=this.draw(i.hex,d,h,u.average+u.standardDeviation,l,!1);if(h>0&&null!==f&&null!==p&&null!==c&&null!==l){var v=f.x-c.x,g=Math.min(l.y,p.y)-Math.max(c.y,f.y),A=new m(c.x,Math.max(c.y,f.y));this.drawRect(A,v,g,i.hex);var y=new m(l.x,Math.min(p.y,l.y));l.y>p.y?this.drawTrangle(y,v,l.y-p.y,i.hex,"bottom-left"):this.drawTrangle(y,v,p.y-l.y,i.hex,"bottom-right");var b=new m(l.x,Math.min(f.y,c.y));c.y>f.y?this.drawTrangle(b,v,c.y-f.y,i.hex,"top-right"):this.drawTrangle(b,v,f.y-c.y,i.hex,"top-left")}l=p,c=f}}}},{key:"createAxisMeasurement",value:function(e){var t=document.createElement("div");t.className="measurement",this.element.appendChild(t);return t.innerHTML=w(e,1).toString(),t}},{key:"createAxes",value:function(){for(var e=0;e<this.xAxisMeasurements;e++){var t=this.time/this.xAxisMeasurements*e/Re.tps;"minutes"===this.timeUnit&&(t/=60);var i=this.createAxisMeasurement(t);i.classList.add("x"),i.style.left=this.width/this.xAxisMeasurements*e*(this.xAxisMeasurements+1)/this.xAxisMeasurements+"px"}for(var n=0;n<7;n++){var a=this.minY+n*(this.maxY-this.minY)/6,s=this.createAxisMeasurement(a);s.classList.add("y"),s.style.bottom=this.height/6*n+"px"}}},{key:"createLabels",value:function(){var e=document.createElement("div");e.className="label x-label",this.element.appendChild(e),"seconds"===this.timeUnit?e.innerHTML="Seconds":"minutes"===this.timeUnit&&(e.innerHTML="Minutes");var t=document.createElement("div");t.className="label y-label",this.element.appendChild(t);var i=this.options.dependentVariable;t.innerHTML=i}}]),e}(),se=!1,re=[{text:"Extrapolate values",type:"checkbox",description:"Reduces the amount of nodes rendered, will significantly reduce lag in extreme scenarios.",defaultValue:!1},{text:"Automatically update",type:"checkbox",defaultValue:!0},{text:"Show points",type:"checkbox",defaultValue:!0},{text:"Show lines",type:"checkbox",defaultValue:!0}],oe=[{display:"Number of creatures",id:"creatures",colour:"#26ff1f",dependentVariable:"Creatures",type:"simple"},{display:"Number of fruit",id:"fruit",colour:"#19c6ff",dependentVariable:"Fruit",type:"simple"},{display:"Fruit multiplier",id:"fruit-multiplier",colour:"#31ff2e",dependentVariable:"Multiplier",type:"simple"}],ce=new Array;function le(){!function(){for(var e=0,t=Object.entries(V);e<t.length;e++){var i=Object(v.a)(t[e],2),n=i[0],a=i[1];oe.push({display:"Creature ".concat(a.display),id:n,colour:a.colour,dependentVariable:a.display,min:a.min,max:a.max,type:"detailed"})}}(),function(){var e=A("graph-viewer").querySelector(".settings-container"),t=re.map((function(e,t){var i,n=function(){var t,i=Object(o.a)(re);try{for(i.s();!(t=i.n()).done;)t.value.requirement,e.text}catch(n){i.e(n)}finally{i.f()}he()},a="graph-setting-".concat(t);switch(e.type){case"checkbox":i=Object(_.jsx)(H,{name:a,text:e.text,defaultValue:e.defaultValue,func:function(t){e.isChecked=t,n()}},t);break;case"range":i=Object(_.jsx)(W,{text:e.text,defaultValue:e.defaultValue,min:e.min,max:e.max,step:e.step,func:function(t){e.value=t,n()}},t)}return e.elem=i,i}));r.a.render(t,e)}(),function(){var e,t=Object(o.a)(re);try{for(t.s();!(e=t.n()).done;){var i=e.value;"checkbox"===i.type&&(i.isChecked=i.defaultValue)}}catch(n){t.e(n)}finally{t.f()}}();var e=A("graph-viewer").querySelector(".options-container"),t=Object(_.jsx)(_.Fragment,{children:oe.map((function(e,t){return Object(_.jsx)(H,{name:e.id,text:e.display,defaultValue:!1,func:function(i){if(e.isSelected=i,i){for(var n=!1,a=0;a<ce.length;a++){if(oe.indexOf(ce[a])>t){ce.splice(a,0,e),n=!0;break}}n||ce.push(e)}else{var s=ce.indexOf(e);ce.splice(s,1)}he()}},t)}))});r.a.render(t,e)}function he(){var e=A("graph-viewer").querySelector(".graph-container");if(0!==ce.length){e.innerHTML="";var t,i={shouldExtrapolate:re[0].isChecked},n=Object(o.a)(ce);try{var a=function(){var n=t.value,a=void 0;"simple"===n.type?a=Ee.map((function(e){return e[n.id]})):"detailed"===n.type&&(a=Ee.map((function(e){return null!==e.genePool?e.genePool[n.id]:null})));var s=new ae(350,210,a,i,n);e.appendChild(s.element)};for(n.s();!(t=n.n()).done;)a()}catch(s){n.e(s)}finally{n.f()}}else e.innerHTML="<p>Your graph will appear here once you choose an option.</p>"}var ue=function(){return!A("board").classList.contains("hidden")};function de(){var e=A("board");e.style.top="calc(50% + ".concat(Re.transform.translate.y,"%)"),e.style.left="calc(50% + ".concat(Re.transform.translate.x,"%)"),e.style.transform="translate(-50%, -50%) scale(".concat(Re.transform.zoom,", ").concat(Re.transform.zoom,")")}var fe=function(e){if(ue()){var t=Re.transform.translate;switch(e){case"up":t.y+=5;break;case"right":t.x-=5;break;case"down":t.y-=5;break;case"left":t.x+=5}de()}},pe=function(e){if(ue()){switch(e){case"in":Re.transform.zoom*=1.15;break;case"out":Re.transform.zoom/=1.15}de()}};var ve=function(e,t,i,n,a,s){var r=j(e,t,a),o=j(i,n,a);return j(r,o,s)},me=function(e){return e*e*e*(e*(6*e-15)+10)};function ge(e,t,i){for(var n=new Array,a=0;a<t;a++){for(var s=new Array,r=0;r<e;r++)s.push(g.randomUnitVector());n.push(s)}for(var o=new Array,c=0;c<t;c++){for(var l=new Array,h=0;h<e;h++){for(var u=h/i,d=c/i,f=new m(u,d),p=Math.floor(u),v=p+1,A=Math.floor(d),y=A+1,b=[[A,p],[A,v],[y,p],[y,v]],x=new Array,j=0;j<4;j++){var w=b[j],O=n[w[0]][w[1]],k=new m(w[1],w[0]),S=f.convertToPolar(k),C=O.convertToCartesian().dot(S.convertToCartesian());x.push(C)}var N=me(u%1),E=me(d%1),M=ve(x[0],x[1],x[2],x[3],N,E);M=Math.min(Math.max(M,-.5),.5),l.push(M)}o.push(l)}return o}var Ae,ye={presets:[{name:"Countryside",noise:["height"],terrainTypes:[{height:1,type:"grass"}]},{name:"Biomes",noise:["height","temperature"],terrainTypes:[{height:[.8,1],type:"mountain"},{temperature:.3,type:"tundra"},{temperature:.7,type:"grass"},{temperature:1,type:"desert"}]},{name:"Archipelago",noise:["height","temperature"],terrainTypes:[{height:.1,type:"deepWater"},{height:.3,type:"water"},{temperature:.3,type:"tundra"},{temperature:.7,type:"grass"},{temperature:1,type:"desert"}]},{name:"Hell",noise:["height"],terrainTypes:[{height:.35,type:"lava"},{height:.8,type:"magma"},{height:1,type:"mountain"}]},{name:"Russia",noise:["height"],terrainTypes:[{height:.1,type:"deepWater"},{height:.3,type:"water"},{height:.7,type:"tundra"},{height:1,type:"mountain"}]},{name:"???",noise:["height"],terrainTypes:[{height:.3,type:"grass"},{height:.4,type:"tundra"},{height:.5,type:"mountain"},{height:.6,type:"desert"},{height:.7,type:"magma"},{height:.8,type:"water"},{height:.9,type:"deepWater"},{height:1,type:"lava"}]}],tiles:{grass:{name:"Grass",colour:"#23ee2d",fruitColour:"#009124",isLiquid:!1},tundra:{name:"Tundra",colour:"#b8c6db",fruitColour:"#0066ff",isLiquid:!1},mountain:{name:"Mountain",colour:"#fff",fruitColour:"#cf13bf",isLiquid:!1},desert:{name:"Desert",colour:"yellow",fruitColour:"#666",isLiquid:!1},magma:{name:"Magma",colour:"orange",fruitColour:"red",isLiquid:!1},water:{name:"Water",colour:"blue",isLiquid:!0},deepWater:{name:"Deep water",colour:"darkblue",isLiquid:!0},lava:{name:"Lava",colour:"red",isLiquid:!0}}},be=function(){function e(t,i,n){Object(c.a)(this,e),this.width=void 0,this.height=void 0,this.tileSize=void 0,this.canvas=void 0,this.tiles=void 0,this.width=t,this.height=i,this.tileSize=n,this.canvas=this.instantiate()}return Object(l.a)(e,[{key:"instantiate",value:function(){var e=document.createElement("canvas");return e.setAttribute("width",this.width*this.tileSize+"px"),e.setAttribute("height",this.height*this.tileSize+"px"),A("board-preview-container").appendChild(e),e}},{key:"changeSize",value:function(e,t){this.width=e,this.height=t,this.canvas.setAttribute("width",this.width*this.tileSize+"px"),this.canvas.setAttribute("height",this.height*this.tileSize+"px")}},{key:"getTiles",value:function(){return this.tiles}},{key:"getTileType",value:function(e,t,i){var n,a=Object(o.a)(e.terrainTypes);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s.height){if("number"===typeof s.height){if(t<=s.height)return ye.tiles[s.type]}else if(Array.isArray(s.height)&&t>=s.height[0]&&t<=s.height[1])return ye.tiles[s.type]}else if(s.temperature)if("number"===typeof s.temperature){if(i<=s.temperature)return ye.tiles[s.type]}else if(Array.isArray(s.height)&&i>=s.temperature[0]&&i<=s.temperature[1])return ye.tiles[s.type]}}catch(r){a.e(r)}finally{a.f()}}},{key:"generateNoise",value:function(e){this.tiles=new Array;for(var t=0;t<this.height;t++)this.tiles[t]=new Array(this.width);var i,n={},a=Object(o.a)(e.noise);try{for(a.s();!(i=a.n()).done;){var s=i.value;"height"===s?n.height=ge(this.width,this.height,5):"temperature"===s&&(n.temperature=ge(this.width,this.height,5))}}catch(p){a.e(p)}finally{a.f()}this.clearCanvas();for(var r=this.canvas.getContext("2d"),c=0;c<this.height;c++)for(var l=0;l<this.width;l++){var h=n.height?n.height[c][l]+.5:null,u=n.temperature?n.temperature[c][l]+.5:null,d=this.getTileType(e,h,u);this.tiles[c][l]=d;var f=d.colour;r.beginPath(),r.fillStyle=f,r.rect(l*this.tileSize,c*this.tileSize,this.tileSize,this.tileSize),r.fill()}this.drawGridLines()}},{key:"generateTestOctaveNoise",value:function(e,t,i,n){var a=function(e,t,i,n,a,s){for(var r=new Array,o=0;o<n;o++){var c=1/Math.pow(a,o)*i,l=Math.pow(s,o),h=ge(e,t,c);if(0===o)r=h;else for(var u=0;u<t;u++)for(var d=0;d<e;d++)r[u][d]+=h[u][d]*l}return r}(this.width,this.height,e,t,i,n);this.drawTestNoise(a)}},{key:"generateTestNoise",value:function(e){var t=ge(this.width,this.height,e);this.drawTestNoise(t)}},{key:"drawTestNoise",value:function(e){this.clearCanvas();for(var t=this.canvas.getContext("2d"),i=0;i<this.height;i++)for(var n=0;n<this.width;n++){var a=e[i][n];t.beginPath();var s="#"+k.grayscale(a+.5);t.fillStyle=s,t.rect(n*this.tileSize,i*this.tileSize,this.tileSize,this.tileSize),t.fill()}}},{key:"drawGridLines",value:function(){for(var e=this.canvas.getContext("2d"),t=1;t<this.height;t++)e.moveTo(0,t*this.tileSize),e.lineTo(this.width*this.tileSize,t*this.tileSize);for(var i=1;i<this.width;i++)e.moveTo(i*this.tileSize,0),e.lineTo(i*this.tileSize,this.height*this.tileSize);e.strokeStyle="#000",e.stroke()}},{key:"clearCanvas",value:function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)}}]),e}(),xe=function(e){var t=e.options,i=e.name,a=e.text,s=e.defaultValue,r=e.func,o=Object(n.useRef)(null),c=Object(n.useState)(s),l=Object(v.a)(c,2),h=l[0],u=l[1],d="_INPUT_"+i;return Object(_.jsxs)("div",{className:"input-select",children:[Object(_.jsx)("label",{htmlFor:d,children:a}),Object(_.jsx)("select",{ref:o,value:h,onChange:function(e){var t=e.target.value;u(t),r&&r(t)},children:t.map((function(e,t){return Object(_.jsx)("option",{children:e},t)}))})]})},je=(i(37),function(e){var t=e.text;return Object(_.jsxs)("div",{className:"warning",children:[Object(_.jsx)("h3",{children:"Warning"}),Object(_.jsx)("p",{children:t})]})}),we=function(e){var t=e.text,i=e.defaultValue,a=e.func,s=e.limit,r=Object(n.useRef)(null),o=Object(n.useState)(i),c=Object(v.a)(o,2),l=c[0],h=c[1],u=null;return isNaN(l)?u="The input must be a valid number.":0===l?u="You must have an input value.":l%1!==0?u="The input must be an integer.":s&&l>s&&(u="The input cannot be greater than ".concat(s,".")),Object(_.jsxs)("div",{className:"input-text",children:[Object(_.jsxs)("span",{className:"text",children:[t,":"]}),Object(_.jsx)("input",{ref:r,onInput:function(){var e=Number(r.current.value);a&&a(e),h(e)},type:"text",defaultValue:i}),null!==u?Object(_.jsx)(je,{text:u}):""]})},Oe=ye.presets[0],ke=function(){Ae.changeSize(Re.boardSize.width,Re.boardSize.height),Ae.generateNoise(Oe)};var Se=function(){var e=Object(n.useState)(!1),t=Object(v.a)(e,2),i=t[0],a=t[1];Object(n.useEffect)((function(){(Ae=new be(Re.boardSize.width,Re.boardSize.height,16)).generateNoise(ye.presets[0])}),[]);var s=ye.presets.map((function(e){return e.name}));return Object(_.jsxs)("div",{id:"terrain-generator",children:[Object(_.jsx)("h2",{className:"subheading",children:"Terrain Generation"}),Object(_.jsx)(H,{name:"show-terrain-generator-checkbox",text:"Advanced terrain generation",defaultValue:!1,func:function(e){a(e)}}),Object(_.jsx)(we,{func:function(e){return Re.boardSize.width=e},text:"Width",defaultValue:15,limit:100}),Object(_.jsx)(we,{func:function(e){return Re.boardSize.height=e},text:"Height",defaultValue:15,limit:100}),i?Object(_.jsx)(_.Fragment,{}):Object(_.jsx)(_.Fragment,{children:Object(_.jsx)(xe,{options:s,name:"terrain-preset-options",text:"Presets:",defaultValue:ye.presets[0].name,func:function(e){var t,i=Object(o.a)(ye.presets);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.name===e){Oe=n,Ae.changeSize(Re.boardSize.width,Re.boardSize.height),Ae.generateNoise(n);break}}}catch(a){i.e(a)}finally{i.f()}}})}),Object(_.jsx)("button",{onClick:ke,children:"Generate"}),Object(_.jsx)("div",{id:"board-preview-container"})]})},Ce=function(){function e(t,i,n){Object(c.a)(this,e),this.width=void 0,this.height=void 0,this.cellSize=void 0,this.cells=void 0,this.landTileIndexes=new Array,this.tiles=void 0,this.width=t,this.height=i,this.cellSize=n,this.cells=new Array(t*i);for(var a=0;a<t*i;a++)this.cells[a]=[];this.tiles=this.generateTiles()}return Object(l.a)(e,[{key:"createCell",value:function(){var e=document.createElement("div");return e.className="cell",e}},{key:"createCellRow",value:function(){var e=document.createElement("div");return e.style.height="".concat(this.cellSize,"px"),e.className="cell-row",e}},{key:"generateTiles",value:function(){var e=Ae.getTiles(),t=A("board");t.classList.remove("hidden");t.style.setProperty("--cell-size","".concat(this.cellSize,"px")),t.style.setProperty("--cell-border-size","".concat(2,"px"));var i=this.width*this.cellSize;t.style.width="".concat(i,"px");var n=this.height*this.cellSize;t.style.height="".concat(n,"px");for(var a=new Array,s=0;s<this.height;s++){var r=this.createCellRow();t.appendChild(r),a.push(r);for(var o=0;o<this.width;o++){var c=e[s][o];c.isLiquid||this.landTileIndexes.push(s*this.width+o);var l=this.createCell();l.style.backgroundColor=c.colour,r.appendChild(l)}}return e}},{key:"createEntity",value:function(e){var t=this.getCellNumbers(e.position,e.size/2);this.insertEntity(e,t)}},{key:"deleteEntity",value:function(e){var t=this.getCellNumbers(e.position,e.size/2);this.removeEntity(e,t)}},{key:"updateEntity",value:function(e){var t=this.getEntityReferences(e),i=this.getCellNumbers(e.position,e.size/2);i!==t&&(this.removeEntity(e,t),this.insertEntity(e,i))}},{key:"getNearby",value:function(e,t){for(var i=Math.max(Math.floor((e.x-t)/this.cellSize),0),n=Math.min(Math.floor((e.x+t)/this.cellSize),this.width-1),a=Math.max(Math.floor((e.y-t)/this.cellSize),0),s=Math.min(Math.floor((e.y+t)/this.cellSize),this.height-1),r=new Array,c=a;c<=s;c++)for(var l=i;l<=n;l++){var h,u=c*this.width+l,d=Object(o.a)(this.cells[u]);try{for(d.s();!(h=d.n()).done;){var f=h.value,p=e.distanceFrom(f.position);!r.includes(f)&&p-f.size/2<=t&&r.push(f)}}catch(v){d.e(v)}finally{d.f()}}return r}},{key:"randomPosition",value:function(){var e=x(this.landTileIndexes),t=e%this.width,i=Math.floor(e/this.width),n=b(0,this.cellSize),a=b(0,this.cellSize);return new m(t*this.cellSize+n,i*this.cellSize+a)}},{key:"getFruitColour",value:function(e){var t=Math.floor(e.x/this.cellSize),i=Math.floor(e.y/this.cellSize),n=this.tiles[i][t];return n.isLiquid&&console.warn("Tried to find the fruit colour of a liquid!"),n.fruitColour}},{key:"randomPositionInCell",value:function(e){var t=e%this.width,i=Math.floor(e/this.width),n=b(0,this.cellSize),a=b(0,this.cellSize);return new m(t*this.cellSize+n,i*this.cellSize+a)}},{key:"randomNearbyPosition",value:function(e,t){for(var i=null;null===i;){var n=e.randomOffset(t);this.positionIsInBoard(n)&&(i=n)}return i}},{key:"census",value:function(){var e=this;return new Promise((function(t){var i,n=new Array,a=new Array,s=Object(o.a)(e.cells);try{for(s.s();!(i=s.n()).done;){var r,c=i.value,l=Object(o.a)(c);try{for(l.s();!(r=l.n()).done;){var h=r.value;h instanceof X&&!n.includes(h)?n.push(h):h instanceof z&&!a.includes(h)&&a.push(h),h.tick()}}catch(u){l.e(u)}finally{l.f()}}}catch(u){s.e(u)}finally{s.f()}t({creatures:n,fruit:a})}))}},{key:"insertEntity",value:function(e,t){var i,n=Object(o.a)(t);try{for(n.s();!(i=n.n()).done;){var a=i.value;this.cells[a].push(e)}}catch(s){n.e(s)}finally{n.f()}}},{key:"removeEntity",value:function(e,t){var i,n=Object(o.a)(t);try{for(n.s();!(i=n.n()).done;){var a=i.value,s=this.cells[a].indexOf(e);this.cells[a].splice(s,1)}}catch(r){n.e(r)}finally{n.f()}}},{key:"getEntityReferences",value:function(e){for(var t=new Array,i=0;i<this.cells.length;i++)this.cells[i].includes(e)&&t.push(i);return t}},{key:"getCellNumbers",value:function(e,t){var i=(e.x+this.cellSize)%this.cellSize,n=(e.y+this.cellSize)%this.cellSize,a=Math.floor(e.x/this.cellSize),s=Math.floor(e.y/this.cellSize),r=new m(i,n),o=s*this.width+a,c=[o];r.x-t<0&&c.push(o-1),r.x+t>this.cellSize&&c.push(o+1),r.y-t<0&&c.push(o-this.width),r.y+t>this.cellSize&&c.push(o+this.width),r.x-t<0&&r.y-t<0&&c.push(o-this.width-1),r.x-t<0&&r.y+t>this.cellSize&&c.push(o+this.width-1),r.x-t>this.cellSize&&r.y-t<0&&c.push(o-this.width+1),r.x-t>this.cellSize&&r.y+t>this.cellSize&&c.push(o+this.width+1);for(var l=this.width*this.height-1,h=c.length-1;h>=0;h--){var u=c[h];(u<0||u>l)&&c.splice(h,1)}return c}},{key:"positionIsInBoard",value:function(e){return e.x>=0&&e.x<=this.width*this.cellSize&&e.y>=0&&e.y<=this.height*this.cellSize}}]),e}(),Ne=[],Ee=new Array,Me=function(e,t){var i={};if(0===e.length)i=null;else{for(var n={},a=0,s=Object.keys(V);a<s.length;a++){n[s[a]]=new Array}var r,c=Object(o.a)(e);try{for(c.s();!(r=c.n()).done;)for(var l=r.value,h=0,u=Object.keys(n);h<u.length;h++){var d=u[h];n[d].push(l[d])}}catch(C){c.e(C)}finally{c.f()}for(var f=0,p=Object.keys(V);f<p.length;f++){for(var v=p[f],m=n[v],g=m.length,A=Number.MAX_SAFE_INTEGER,y=0,b=0,x=0;x<g;x++){var j=m[x];j<A&&(A=j),j>y&&(y=j),b+=j}b/=g,i[v]={average:b,min:A,max:y,standardDeviation:O(m)}}}var w=S.count(X);0===w&&(w=null);var k=S.count(z);Ee.push({creatures:w,fruit:k,genePool:i,fruitMultiplier:Te.fruitMultiplier}),re[1].isChecked&&he()},ze={fruitSpawnRate:1,creatureMutationRate:1,eggIncubationTime:5,initialCreatures:10,initialFruit:50,equilibrium:20,showDebugOutput:!1},Te={hasStarted:!1,isPaused:!1,ticks:0,tps:20,timewarp:1,fruitMultiplier:1,previousTime:Date.now(),previousTicks:0,runTick:function(){var e=Object(d.a)(u.a.mark((function e(){var t,i,n,a,s,r,c,l,h,d,f,p,v,m=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPaused){e.next=3;break}return setTimeout((function(){return m.runTick()}),1e3/this.tps/this.timewarp),e.abrupt("return");case 3:this.previousTicks++,t=Object(o.a)(Ne);try{for(t.s();!(i=t.n()).done;)(0,i.value)()}catch(u){t.e(u)}finally{t.f()}n=Object(o.a)(T);try{for(n.s();!(a=n.n()).done;)a.value.tick()}catch(u){n.e(u)}finally{n.f()}if(!this.hasStarted){e.next=22;break}return this.ticks++,document.querySelectorAll(".ray").forEach((function(e){return e.remove()})),e.next=13,Te.board.census();case 13:for(s=e.sent,r=s.creatures.length,this.fruitMultiplier=0===r?1:this.settings.equilibrium/r,c=.05*this.settings.fruitSpawnRate*this.fruitMultiplier,l=0;l<this.board.landTileIndexes.length;l++)for(h=this.board.landTileIndexes[l],d=Math.random(),f=0;d<=c/this.tps-f;f++)C(h);K(),F&&E(),10,this.ticks/this.tps%10===0&&Me(s.creatures,s.fruit);case 22:p=Date.now(),v=p-this.previousTime,p-this.previousTime>=1e3&&(this.settings.showDebugOutput&&console.log(this.previousTicks+" ticks in "+v+"ms"),this.previousTicks=0,this.previousTime=p),setTimeout((function(){return m.runTick()}),1e3/this.tps/this.timewarp);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),start:function(){A("title-options-container").classList.add("hidden"),this.board=new Ce(this.boardSize.width,this.boardSize.height,this.cellSize),this.hasStarted=!0,this.transform.zoom=25/Math.pow(this.boardSize.width+this.boardSize.height,1.1),de();for(var e=0;e<this.settings.initialCreatures;e++)J();for(var t=0;t<this.settings.initialFruit;t++)C()},createRenderListener:function(e){Ne.push(e)},removeRenderListener:function(e){if(-1===Ne.indexOf(e))throw new Error("No matching function could be found! Name: ".concat(e.name));Ne.push(e)},hasRenderListener:function(e){return Ne.indexOf(e)>=0},boardSize:{width:15,height:15},transform:{zoom:1,translate:new m(0,0)},cellSize:60,settings:ze,board:null},Re=Te,Fe=[],Ie=function(){function e(){Object(c.a)(this,e),this.element=void 0,this.position=void 0,this.velocity=void 0,this.element=this.createInstance(),this.position=this.getRandomPosition(),this.velocity=this.getRandomVelocity()}return Object(l.a)(e,[{key:"getRandomPosition",value:function(){var e=b(0,90)+5,t=b(0,90)+5- -10;return new m(e,t)}},{key:"getRandomVelocity",value:function(){var e=b(-2,2),t=b(-12,-5);return new m(e,t)}},{key:"createInstance",value:function(){var e=document.createElement("div");e.className="confetti",document.body.appendChild(e);var t=[3,7],i=[5,12],n=b(t[0],t[1]),a=b(i[0],i[1]);e.style.width="".concat(n,"px"),e.style.height="".concat(a,"px");var s=180*Math.random();e.style.transform="rotate(".concat(s,"deg)");var r=x(["red","pink","orange","green","blue"]);return e.style.backgroundColor=r,e}},{key:"updatePosition",value:function(){this.element.style.left="".concat(this.position.x,"%"),this.element.style.top="".concat(this.position.y,"%")}},{key:"tick",value:function(){for(var e=0;e<7;e++)this.position=this.position.lerp(this.position.add(this.velocity),1/Re.tps),this.velocity.y+=.05;(this.position.y>100||this.position.x<0||this.position.x>100)&&this.die(),this.updatePosition()}},{key:"die",value:function(){this.element.remove();var e=Fe.indexOf(this);Fe.splice(e,1)}}]),e}(),Le=function(){var e,t=Object(o.a)(Fe);try{for(t.s();!(e=t.n()).done;){e.value.tick()}}catch(i){t.e(i)}finally{t.f()}};i(38),i(39);function Pe(){A("start-menu").classList.remove("hidden")}var Ue=JSON.parse(JSON.stringify(ze)),De=function(){Re.settings=Ue,A("start-menu").remove(),Re.start()},Ve=function(){return Object(_.jsx)("div",{id:"start-menu",className:"menu hidden",children:Object(_.jsxs)("div",{className:"content",children:[Object(_.jsx)("h1",{className:"heading",children:"Settings"}),Object(_.jsx)(Se,{}),Object(_.jsx)("h2",{className:"subheading",children:"Initial Population"}),Object(_.jsx)(W,{func:function(e){return Ue.initialCreatures=e},text:"Creatures",min:0,max:100,step:1,defaultValue:10}),Object(_.jsx)(W,{func:function(e){return Ue.initialFruit=e},text:"Fruit",min:0,max:500,step:5,defaultValue:50}),Object(_.jsx)("h2",{className:"subheading",children:"Modifiers"}),Object(_.jsx)(W,{func:function(e){return Ue.fruitSpawnRate=e},text:"Fruit spawn rate",min:.5,max:5,step:.5,defaultValue:1,hasExtremeMode:!0}),Object(_.jsx)(W,{func:function(e){return Ue.creatureMutationRate=e},text:"Creature mutation rate",min:.5,max:3,step:.1,defaultValue:1,hasExtremeMode:!0}),Object(_.jsx)(W,{func:function(e){return Ue.eggIncubationTime=e},text:"Egg incubation time",min:0,max:15,step:1,defaultValue:5,hasExtremeMode:!0}),Object(_.jsx)("h2",{className:"subheading",children:"Other Stuff"}),Object(_.jsx)("p",{children:"I couldn't figure out where to put these so now this is here."}),Object(_.jsx)(W,{func:function(e){return Ue.equilibrium=e},text:"Desired equilibrium",min:0,max:100,step:5,defaultValue:20}),Object(_.jsx)("button",{onClick:De,children:"Start"})]})})},Ge=function(){var e;null===(e=window.open("https://github.com/eggpoison/creature-simulator","_blank"))||void 0===e||e.focus()},Be=function(){return Object(_.jsxs)("div",{id:"titlescreen",children:[Object(_.jsx)("h1",{children:"Creature Simulator"}),Object(_.jsxs)("div",{id:"title-options-container",children:[Object(_.jsx)("button",{onClick:Pe,children:"Start"}),Object(_.jsx)("button",{onClick:function(){return function(e){for(var t=0;t<e;t++)Fe.push(new Ie);Re.hasRenderListener(Le)||Re.createRenderListener(Le)}(50)},children:"Confetti!"}),Object(_.jsx)("button",{children:"About"}),Object(_.jsx)("button",{onClick:Ge,id:"source-code-button",children:"Source Code"})]})]})},Ye=(i(40),i(41),i(42),function(){return Object(_.jsx)("div",{id:"board",className:"hidden"})}),Je=(i(43),function(){var e=Object(n.useState)(null),t=Object(v.a)(e,2),i=t[0],s=t[1],r=a.a.useState({}),o=Object(v.a)(r,2)[1],c=a.a.useCallback((function(){return o({})}),[]);Object(n.useEffect)((function(){N=function(e){s(e)},function(e){E=e}((function(){return c()}))}),[c]);var l=null===i?Object(_.jsx)(_.Fragment,{}):Object(_.jsxs)(_.Fragment,{children:[" ",Object.entries(V).map((function(e,t){var n=e[1],a=e[0],s=i[a],r=(s-n.min)/(n.max-n.min)*100,o=.5+(s-n.min)/(n.max-n.min)/2;return Object(_.jsxs)("div",{className:"gene",children:[Object(_.jsx)("div",{className:"label",children:n.display}),Object(_.jsxs)("div",{className:"slider",children:[Object(_.jsx)("div",{style:{width:r+"%",opacity:o,backgroundColor:n.colour},className:"slider-fill"}),Object(_.jsx)("div",{className:"min",children:n.min}),Object(_.jsx)("div",{className:"val",children:s}),Object(_.jsx)("div",{className:"max",children:n.max})]})]},t)}))," "]});return null===i?Object(_.jsx)(_.Fragment,{}):Object(_.jsxs)("div",{id:"creature-inspector",children:[Object(_.jsx)("h1",{children:"Creature Inspector"}),Object(_.jsx)("h2",{children:"General"}),Object(_.jsxs)("div",{className:"panel",children:[Object(_.jsxs)("p",{children:["Name: ",i.name]}),Object(_.jsxs)("p",{children:["Age: ",Re.ticks-i.birthTime," ticks (",w((Re.ticks-i.birthTime)/Re.tps,1)," seconds)"]})]}),Object(_.jsx)("h2",{children:"Stats"}),Object(_.jsxs)("div",{className:"panel",children:[Object(_.jsxs)("p",{children:["Generation: ",i.stats.generation]}),Object(_.jsxs)("p",{children:["Fruit eaten: ",i.stats.fruitEaten]})]}),Object(_.jsx)("h2",{children:"Genes"}),Object(_.jsx)("div",{className:"panel",children:l})]})}),Ke=null,Qe=null;i(44),i(45);var qe=function(){return Object(_.jsxs)("div",{id:"graph-viewer",className:"menu hidden",children:[Object(_.jsx)("h1",{className:"heading",children:"View Graphs"}),Object(_.jsxs)("div",{className:"formatter",children:[Object(_.jsxs)("div",{className:"options",children:[Object(_.jsx)("h2",{className:"subheading",children:"Graph Options"}),Object(_.jsx)("p",{children:"Select which graphs should be shown."}),Object(_.jsx)("div",{className:"options-container"})]}),Object(_.jsxs)("div",{className:"settings",children:[Object(_.jsx)("h2",{className:"subheading",children:"Settings"}),Object(_.jsx)("p",{children:"Control how the graphs look."}),Object(_.jsx)("div",{className:"settings-container"})]})]}),Object(_.jsx)("div",{className:"graph-container",children:Object(_.jsx)("p",{children:"Your graph will appear here once you choose an option."})})]})},Xe=function(){return Object(_.jsx)("div",{id:"pause-screen",className:"hidden",children:Object(_.jsxs)("hgroup",{children:[Object(_.jsx)("h1",{children:"Paused!"}),Object(_.jsxs)("h2",{children:["Press ",Object(_.jsx)("span",{children:"<space>"})," to unpause."]})]})})};i(46);function _e(){A("mask").classList.add("hidden")}function He(){A("mask").classList.remove("hidden")}r.a.render(Object(_.jsxs)(a.a.StrictMode,{children:[Object(_.jsx)(Be,{}),Object(_.jsx)(ne,{}),Object(_.jsx)(Ye,{}),Object(_.jsx)(Je,{}),Object(_.jsx)(qe,{}),Object(_.jsx)(Xe,{}),Object(_.jsx)(Ve,{}),Object(_.jsx)("div",{id:"mask",className:"hidden"})]}),document.getElementById("root"));window.onload=function(){le(),Re.runTick()},document.onmousemove=function(e){var t=A("board");if(e.composedPath().includes(t)){var i=t.getBoundingClientRect();!function(e,t){var i=900/534,n=new m(e*i,t*i);Qe=null;var a,s=50,r=Object(o.a)(Re.board.cells);try{for(r.s();!(a=r.n()).done;){var c,l=a.value,h=Object(o.a)(l);try{for(h.s();!(c=h.n()).done;){var u=c.value;if(u instanceof X){var d=n.distanceFrom(u.position);d<s&&(Qe=u,s=d)}}}catch(g){h.e(g)}finally{h.f()}}}catch(g){r.e(g)}finally{r.f()}!function(){var e;null===(e=document.querySelector(".creature.highlighted"))||void 0===e||e.classList.remove("highlighted")}();var f=A("board");if(null!==Qe){Qe.element.classList.add("highlighted");var p=function(e,t,i){var n=document.createElement("div");return n.className="hover-box",n.style.left=t.x+"px",n.style.top=t.y+"px",n.innerHTML=e,i.appendChild(n),n}(Qe.name,new m(Qe.position.x,Qe.position.y+20+Qe.size/2),f);null!==Ke&&Ke!==p&&Ke.remove(),Ke=p,f.classList.add("highlight")}else{var v;f.classList.remove("highlight"),null===(v=Ke)||void 0===v||v.remove(),Ke=null}}(e.clientX-i.x,e.clientY-i.y)}},document.onclick=function(){var e,t=window.event;if("open-graph-viewer-button"===(null===t||void 0===t?void 0:t.target).id)He(),A("graph-viewer").classList.remove("hidden"),se=!0;else if(se){if(null===t||void 0===t?void 0:t.composedPath().includes(A("graph-viewer")))return;_e(),A("graph-viewer").classList.add("hidden"),se=!1}else null!==Qe?(F=!0,I=e=Qe,N(e)):L()},document.onkeydown=function(){var e=window.event.key;if(document.activeElement===document.body)switch(e){case"ArrowUp":fe("up");break;case"ArrowRight":fe("right");break;case"ArrowDown":fe("down");break;case"ArrowLeft":fe("left");break;case"-":case"_":pe("out");break;case"+":case"=":pe("in");break;case" ":Re.isPaused?(Re.isPaused=!1,A("pause-screen").classList.add("hidden")):(Re.isPaused=!0,A("pause-screen").classList.remove("hidden"))}}}]),[[47,1,2]]]);
//# sourceMappingURL=main.b189ed5b.chunk.js.map